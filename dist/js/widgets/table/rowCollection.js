define(["base/app","base/util","base/model","base/collection"],function(e,t,n,r){var i=r.extend({constructor:function(e,t){var n=this;r.apply(n,arguments),_.each(l,function(e){e(n)})}}),s=function(e){e.setSortKey=function(t){var n=e.getConfigs(),r="asc";t===n.sortKey?(r=n.sortOrder==="asc"?"desc":"asc",e.setConfigs({sortOrder:r})):e.setConfigs({sortKey:t,sortOrder:r})},e.getSorted=function(){var t=e.getConfigs(),n=e.sortBy(t.sortKey);return t.sortOrder!=="asc"&&n.reverse(),n}},o=function(t){var n=t.getOption("sortKey")||"name",r=t.getOption("sortOrder")||"asc",i={};t.addFilter=function(t){var n=e.getHash(JSON.stringify(t));i[n]=t},t.removeFilter=function(t){var n=e.getHash(t),r=i[n];if(!r)throw new Error("Filter missing");delete i[n]},t.getFiltered=function(e){var t=_.values(i);return t.length===0?e:_.filter(e,function(e){return e.checkFilters(t)})},t.getProcessedRecords=function(){var e=t.getConfigs();return e.requestId||t.url?t.toArray():t.getPaginated(t.getFiltered(t.getSorted(t)))},t.processedEach=function(e,n){var r=t.getProcessedRecords();_.each(r,function(r,i){e.call(n||t,r,i)})}},u=function(e){var t=e.getConfigs();e.setConfig("totalRecords",e.length),e.getPaginated=function(n){return t=e.getConfigs(),e.setConfig("totalRecords",n.length),t.paginated?n.splice((t.page-1)*t.perPage,t.perPage):n},e.nextPage=function(){var t=e.getConfigs(),n=Math.ceil(t.totalRecords/t.perPage),r=e.getConfig("page");e.setConfig("page",Math.min(r+1,n))},e.prevPage=function(){var t=e.getConfig("page");e.setConfig("page",Math.max(1,t-1))}},a=function(e){var t=new n({sortOrder:"asc"}),r={setConfig:function(e,n){t.set(e,n)},getConfig:function(e){return t.get(e)},setConfigs:function(e){t.set(e)},getConfigs:function(e){return t.toJSON(e)},getConfigModel:function(){return t}};_.extend(e,r),e.setConfigs(_.extend({},e.getOption("config"))),e.listenTo(t,"all",function(t){e.trigger.apply(e,["config_"+t].concat(_.rest(arguments)))}),t.on("change:page change:perPage",function(e){var t=e.toJSON(),n=(t.page-1)*t.perPage,r=Math.min(n+t.perPage,t.totalRecords);e.set({start:n,end:r})})},f=function(e){},l=[a,o,s,u,f];return i});