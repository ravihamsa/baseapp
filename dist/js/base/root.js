define(["base/view","base/app","widgets/header"],function(e,t,n){var r,i=function(e,n,i){r&&(console.log("currentPageView removed ",(new Date).toLocaleTimeString()),r.remove()),require(["apps/"+e+"/pages/"+n],function(e){var n=new e.View({model:new e.Model(i)}),s=$(t.appBody);s.empty(),s.html(n.el),n.render(),r=n})},s=e.extend({changeHandler:function(e){var t=this.model.toJSON();e.hasOwnProperty("appId")?require(["apps/"+t.appId],function(){require(["apps/"+t.appId+"/app"],function(e){var n=t.pageId||e.defaultPage;i(t.appId,n,t)})}):e.hasOwnProperty("pageId")?require(["apps/"+t.appId+"/app"],function(e){var n=t.pageId||e.defaultPage;i(t.appId,n,t)}):r&&r.model.reset(t)}});return{View:s}});